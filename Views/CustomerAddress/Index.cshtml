@model IEnumerable<CustomerAddressVM>

@{
    ViewData["Title"] = "Addresses for " + (ViewBag.CustomerName ?? "Customer");
    int customerId = ViewBag.CustomerId;
}

<link rel="stylesheet" href="@(Url.Content("~/css/CRUD/Index.css"))" />
<link rel="stylesheet" href="~/css/ListPageHeader.css" />

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">@TempData["Error"]</div>
}
@if (TempData["Success"] != null)
{
    <div class="alert alert-success">@TempData["Success"]</div>
}

<div class="list-page addresses-page">
    <div class="card">

    <div class="header-row" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2 style="margin: 0;">@ViewData["Title"]</h2>

        <a href="@Url.Action("Index", "Customer")"
           class="quick-action-btn card3">
            Back to Customer
        </a>

     </div>

        <!-- Floating Add Button (AJAX) -->
        <a href="javascript:void(0)"
           onclick="openModalWithAjax('@Url.Action("Create", "CustomerAddress", new { customerId = customerId })', 'Create Address')"
           class="floating-btn"
           title="Add Address">
            <i class="fa-solid fa-plus"></i>
        </a>


        @if (Model.Any())
        {
            <table>
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Country</th>
                        <th>City</th>
                        <th>Street</th>
                        <th>Building</th>
                        <th>Apt</th>
                        <th>Actions</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var a in Model)
                    {
                        <tr>
                            <td data-label="Id">@a.Id</td>
                            <td data-label="Country">@a.Country</td>
                            <td data-label="City">@a.City</td>
                            <td data-label="Street">@a.Street</td>
                            <td data-label="Building">@a.BuildingNumber</td>
                            <td data-label="Apt">@a.ApartmentNumber</td>

                            <td data-label="Actions">
                                <div class="action-buttons">

                                    <!-- Edit Address (AJAX) -->
                                    <a href="javascript:void(0)" 
                                       onclick="openModalWithAjax('@Url.Action("Edit", "CustomerAddress", new { id = a.Id })', 'Edit Address')"
                                       class="btn btn-update btn-sm" 
                                       title="Edit Address">
                                        <i class="fa-solid fa-pen"></i>
                                    </a>


                                    <!-- Delete -->
                                    <form asp-action="Delete"
                                          method="post"
                                          class="d-inline"
                                          onsubmit="return confirm('Are you sure you want to delete this address?');">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="id" value="@a.Id" />
                                        <button type="submit"
                                                class="btn btn-delete btn-sm"
                                                title="Delete Address">
                                            <i class="fa-solid fa-trash"></i>
                                        </button>
                                    </form>

                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div class="alert alert-info">No addresses yet for this customer.</div>
        }
    </div>
</div>
@await Html.PartialAsync("_GeneralModal")
